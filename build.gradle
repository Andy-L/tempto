/*
 * Copyright 2015, Teradata, Inc. All rights reserved.
 */

apply plugin: 'idea'
apply plugin: 'java'
apply plugin: 'groovy'

plugins.withType(JavaPlugin) {
  sourceCompatibility = 1.8
  targetCompatibility = 1.8
}

allprojects {
  repositories {
    maven {
      url 'http://phabricator.td.teradata.com:8081/nexus/content/groups/hadapt-deps'
    }
  }
}

ext.versions = [
        assertj      : '2.0.0',
        guava        : '18.0',
        guice        : '4.0-beta5',
        log4j        : '1.2.17',
        testng       : '6.8',
        spock        : '1.0-groovy-2.4',
        slf4j        : '1.7.5',
        reportng     : '1.1.4',
        hsqldb       : '2.3.2',
        dbutils      : '1.6',
        snakeyaml    : '1.15',
        cglib        : '3.1',
        httpclient   : '4.4',
        ioutils      : '2.4',
        tpchgen      : '0.4',
        jsonpath     : '2.0.0',
        commons_lang3: '3.3.2',
        commons_dbcp2: '2.1',
        hive         : '0.12.0-cdh5.1.2',
        hadoop       : '0.20.2',
        presto       : '0.97',
        reflections  : '0.9.9',
        bytebuddy    : '0.5.6'
]

ext.libraries = [
        assertj      : "org.assertj:assertj-core:${versions.assertj}",
        guava        : "com.google.guava:guava:${versions.guava}",
        guice        : "com.google.inject:guice:${versions.guice}",
        log4j        : "log4j:log4j:${versions.log4j}",
        testng       : "org.testng:testng:${versions.testng}",
        commons_lang3: "org.apache.commons:commons-lang3:${versions.commons_lang3}",
        commons_dbcp2: "org.apache.commons:commons-dbcp2:${versions.commons_dbcp2}",
        spock        : ["org.spockframework:spock-core:${versions.spock}",
                        "cglib:cglib:${versions.cglib}"],
        httpclient   : "org.apache.httpcomponents:httpclient:${versions.httpclient}",
        ioutils      : "commons-io:commons-io:${versions.ioutils}",
        hsqldb       : "org.hsqldb:hsqldb:${versions.hsqldb}",
        dbutils      : "commons-dbutils:commons-dbutils:${versions.dbutils}",
        slf4j        : ["org.slf4j:slf4j-api:${versions.slf4j}",
                        "org.slf4j:slf4j-log4j12:${versions.slf4j}"],
        reportng     : "org.uncommons:reportng:${versions.reportng}",
        snakeyaml    : "org.yaml:snakeyaml:${versions.snakeyaml}",
        tpchgen      : "io.airlift.tpch:tpch:${versions.tpchgen}",
        jsonpath     : "com.jayway.jsonpath:json-path:${versions.jsonpath}",
        hive_jdbc    : "org.apache.hive:hive-jdbc:${versions.hive}",
        hadoop_core  : "org.apache.hadoop:hadoop-core:${versions.hadoop}",
        presto_jdbc  : "com.facebook.presto:presto-jdbc:${versions.presto}",
        reflections  : "org.reflections:reflections:${versions.reflections}",
        bytebuddy    : "net.bytebuddy:byte-buddy:${versions.bytebuddy}"
]

ext.test_framework_core = project(':test-framework-core')
ext.test_framework_examples = project(':test-framework-examples')
ext.third_party_deps = project(':third-party-deps')

task wrapper(type: Wrapper) {
  gradleVersion = '2.3'
}

task packageAndUploadLaunchScript(type: Exec) {
  workingDir 'test-framework-launch-script/'
  commandLine 'python', 'setup.py', 'bdist_wheel', 'upload', '-r', 'pypi_internal'
}
